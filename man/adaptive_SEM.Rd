% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/em_algorithm.R
\name{adaptive_SEM}
\alias{adaptive_SEM}
\title{Adaptive Stochastic EM algorithm for point process disentangling}
\usage{
adaptive_SEM(
  pp_data,
  partition,
  partition_processes,
  statespace,
  time_window,
  treatment_time,
  hawkes_params_control,
  hawkes_params_treated,
  N_labellings,
  N_iter,
  verbose = TRUE,
  adaptive_control = list(param_update_cadence = 20, proposal_update_cadence = 1,
    state_spaces = NULL, iter = 100, n_props = 10, change_factor = 0.1, verbose = FALSE,
    update_starting_data = TRUE, include_starting_data = FALSE),
  ...
)
}
\arguments{
\item{pp_data}{Data frame with columns x, y, t, process, location_process}

\item{partition}{A spatstat tess object}

\item{partition_processes}{Character vector of process names per tile}

\item{statespace}{Full observation window (owin)}

\item{time_window}{Numeric vector c(start, end) (used for internal naming)}

\item{treatment_time}{Scalar treatment time}

\item{hawkes_params_control}{Initial control Hawkes parameters}

\item{hawkes_params_treated}{Initial treated Hawkes parameters}

\item{N_labellings}{Number of labeling proposals per outer iteration}

\item{N_iter}{Number of outer EM iterations}

\item{verbose}{Print progress}

\item{adaptive_control}{List of adaptive control parameters}

\item{...}{Additional arguments passed through (e.g. background_rate_var, covariate_lookup)}
}
\value{
List with hawkes_params_control, hawkes_params_treated, t_params,
labellings, adaptive results, and timing
}
\description{
Outer loop of the SEM: runs adaptive labeling proposals, computes
importance weights, and iteratively re-estimates Hawkes parameters.
}
