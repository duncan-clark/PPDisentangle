% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/labelings.R
\name{em_style_labelling}
\alias{em_style_labelling}
\title{EM-style iterative labeling with parameter updates}
\usage{
em_style_labelling(
  pp_data,
  partition,
  partition_processes,
  statespace,
  time_window,
  treatment_time,
  hawkes_params_control,
  hawkes_params_treated,
  update_control_params = FALSE,
  param_update_cadence = 20,
  proposal_update_cadence = 1,
  update_starting_data = TRUE,
  include_starting_data = TRUE,
  optim_method = "max",
  state_spaces = NULL,
  metric_name = "post_likelihood",
  iter = 100,
  n_props = 100,
  change_factor = 0.1,
  MCMC_style = FALSE,
  verbose = FALSE,
  ...
)
}
\arguments{
\item{pp_data}{Data frame with columns x, y, t, process, location_process}

\item{partition}{A spatstat tess object}

\item{partition_processes}{Character vector of process names per tile}

\item{statespace}{Full observation window (owin)}

\item{time_window}{Numeric vector c(start, end)}

\item{treatment_time}{Scalar treatment time}

\item{hawkes_params_control}{Control Hawkes parameters}

\item{hawkes_params_treated}{Treated Hawkes parameters}

\item{update_control_params}{Logical; update control params too}

\item{param_update_cadence}{How often to refit params (every N iterations)}

\item{proposal_update_cadence}{How often to regenerate proposals}

\item{update_starting_data}{Logical; update starting data each iteration}

\item{include_starting_data}{Logical; include current data in proposals}

\item{optim_method}{One of "max", "mean", "truncated_mean"}

\item{state_spaces}{Optional precomputed state spaces}

\item{metric_name}{Metric for selecting best labeling}

\item{iter}{Number of iterations}

\item{n_props}{Number of proposals per iteration}

\item{change_factor}{Scaling factor for relabeling}

\item{MCMC_style}{Use MCMC acceptance/rejection}

\item{verbose}{Print progress}

\item{...}{Additional arguments}
}
\value{
List with labelling, treated_par, control_par, accuracies, etc.
}
\description{
Core inner loop of the SEM algorithm: generates labeling proposals,
selects the best by likelihood, and optionally re-estimates Hawkes parameters.
}
